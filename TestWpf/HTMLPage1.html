<!DOCTYPE html>

<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8" />
    <title></title>
    <script src="F:\代码\ImageViewer\ImageViewer\jquery-3.4.1.min.js"></script>
    <style>
        * {
            padding: 0;
            margin: 0;
        }

        body, html {
            width: 100%;
            height: 100%;
        }

        iframe {
            width: 100%;
            height: 100%;
        }
    </style>
    <script>
        $(function () {
            $(".f").attr("src", "https://e-hentai.org/s/fe846acecc/1622667-5");
            console.log($("#i3>a").html());
            $(".f").on("load", function () {
                if ($("#i7 a").attr("href") == null) {
                    alert($("#img").src);
                    downloadImage($("#img").src, $("#img").src);
                } else {
                    $("#i7 a").click();
                }
                console.log($(window.frames[".f"].document).find("#img").html());
            });
            
            function downloadImage(path, imgName) {
                var _OBJECT_URL;
                var request = new XMLHttpRequest();
                request.addEventListener('readystatechange', function (e) {
                    if (request.readyState == 4) {
                        _OBJECT_URL = URL.createObjectURL(request.response);
                        var $a = $("<a></a>").attr("href", _OBJECT_URL).attr("download", imgName);
                        $a[0].click();
                    }
                });
                request.responseType = 'blob';
                request.open('get', path);
                request.send();
            }
        });
    </script>
</head>
<body>
    <iframe class="f">
    </iframe>
</body>
</html>